!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var r=n(1),o=n(2),i=(n(5),n(9)),a=n(10),s=function(){this.config={element:document.currentScript,url:location.protocol+"//"+location.host+location.pathname,service:"reddit",both:!0};var e=this.config.element.innerHTML.length>0?JSON.parse(this.config.element.innerHTML.trim()):{};this.config=this.extend(this.config,e),console.log(this)};s.prototype.extend=function(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n},s.prototype.renderHtml=function(e){var t=this.config,n=t.element.parentNode,o=document.createElement("div"),s=r.render(i,e,{comment:a});console.log(e),o.className="embedd-container",o.innerHTML=s,n.insertBefore(o,t.element)},s.prototype.hideChildren=function(e){console.log(e);var t=e.target,n=t.parentNode.parentNode.parentNode;n.classList.toggle("closed")},s.prototype.init=function(){var e=this,t=new o(e.config);t.fetch().then(function(t){e.renderHtml(t);for(var n=document.getElementsByClassName("hideChildrenBtn"),r=0;r<n.length;r++)n[r].addEventListener("click",e.hideChildren,!1)})},(new s).init()},function(e,t,n){var r,o,i;/*!
	 * mustache.js - Logic-less {{mustache}} templates with JavaScript
	 * http://github.com/janl/mustache.js
	 */
!function(n,a){"object"==typeof t&&t&&"string"!=typeof t.nodeName?a(t):(o=[t],r=a,i="function"==typeof r?r.apply(t,o):r,!(void 0!==i&&(e.exports=i)))}(this,function(e){function t(e){return"function"==typeof e}function n(e){return m(e)?"array":typeof e}function r(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function o(e,t){return null!=e&&"object"==typeof e&&t in e}function i(e,t){return v.call(e,t)}function a(e){return!i(g,e)}function s(e){return String(e).replace(/[&<>"'\/]/g,function(e){return b[e]})}function c(t,n){function o(){if(g&&!b)for(;v.length;)delete f[v.pop()];else v=[];g=!1,b=!1}function i(e){if("string"==typeof e&&(e=e.split(w,2)),!m(e)||2!==e.length)throw new Error("Invalid tags: "+e);s=new RegExp(r(e[0])+"\\s*"),c=new RegExp("\\s*"+r(e[1])),p=new RegExp("\\s*"+r("}"+e[1]))}if(!t)return[];var s,c,p,h=[],f=[],v=[],g=!1,b=!1;i(n||e.tags);for(var R,U,E,T,L,j,M=new u(t);!M.eos();){if(R=M.pos,E=M.scanUntil(s))for(var S=0,N=E.length;N>S;++S)T=E.charAt(S),a(T)?v.push(f.length):b=!0,f.push(["text",T,R,R+1]),R+=1,"\n"===T&&o();if(!M.scan(s))break;if(g=!0,U=M.scan(C)||"name",M.scan(y),"="===U?(E=M.scanUntil(x),M.scan(x),M.scanUntil(c)):"{"===U?(E=M.scanUntil(p),M.scan(k),M.scanUntil(c),U="&"):E=M.scanUntil(c),!M.scan(c))throw new Error("Unclosed tag at "+M.pos);if(L=[U,E,R,M.pos],f.push(L),"#"===U||"^"===U)h.push(L);else if("/"===U){if(j=h.pop(),!j)throw new Error('Unopened section "'+E+'" at '+R);if(j[1]!==E)throw new Error('Unclosed section "'+j[1]+'" at '+R)}else"name"===U||"{"===U||"&"===U?b=!0:"="===U&&i(E)}if(j=h.pop())throw new Error('Unclosed section "'+j[1]+'" at '+M.pos);return d(l(f))}function l(e){for(var t,n,r=[],o=0,i=e.length;i>o;++o)t=e[o],t&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(r.push(t),n=t));return r}function d(e){for(var t,n,r=[],o=r,i=[],a=0,s=e.length;s>a;++a)switch(t=e[a],t[0]){case"#":case"^":o.push(t),i.push(t),o=t[4]=[];break;case"/":n=i.pop(),n[5]=t[2],o=i.length>0?i[i.length-1][4]:r;break;default:o.push(t)}return r}function u(e){this.string=e,this.tail=e,this.pos=0}function p(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function h(){this.cache={}}var f=Object.prototype.toString,m=Array.isArray||function(e){return"[object Array]"===f.call(e)},v=RegExp.prototype.test,g=/\S/,b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},y=/\s*/,w=/\s+/,x=/\s*=/,k=/\s*\}/,C=/#|\^|\/|>|\{|&|=|!/;u.prototype.eos=function(){return""===this.tail},u.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},u.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},p.prototype.push=function(e){return new p(e,this)},p.prototype.lookup=function(e){var n,r=this.cache;if(r.hasOwnProperty(e))n=r[e];else{for(var i,a,s=this,c=!1;s;){if(e.indexOf(".")>0)for(n=s.view,i=e.split("."),a=0;null!=n&&a<i.length;)a===i.length-1&&(c=o(n,i[a])),n=n[i[a++]];else n=s.view[e],c=o(s.view,e);if(c)break;s=s.parent}r[e]=n}return t(n)&&(n=n.call(this.view)),n},h.prototype.clearCache=function(){this.cache={}},h.prototype.parse=function(e,t){var n=this.cache,r=n[e];return null==r&&(r=n[e]=c(e,t)),r},h.prototype.render=function(e,t,n){var r=this.parse(e),o=t instanceof p?t:new p(t);return this.renderTokens(r,o,n,e)},h.prototype.renderTokens=function(e,t,n,r){for(var o,i,a,s="",c=0,l=e.length;l>c;++c)a=void 0,o=e[c],i=o[0],"#"===i?a=this.renderSection(o,t,n,r):"^"===i?a=this.renderInverted(o,t,n,r):">"===i?a=this.renderPartial(o,t,n,r):"&"===i?a=this.unescapedValue(o,t):"name"===i?a=this.escapedValue(o,t):"text"===i&&(a=this.rawValue(o)),void 0!==a&&(s+=a);return s},h.prototype.renderSection=function(e,n,r,o){function i(e){return a.render(e,n,r)}var a=this,s="",c=n.lookup(e[1]);if(c){if(m(c))for(var l=0,d=c.length;d>l;++l)s+=this.renderTokens(e[4],n.push(c[l]),r,o);else if("object"==typeof c||"string"==typeof c||"number"==typeof c)s+=this.renderTokens(e[4],n.push(c),r,o);else if(t(c)){if("string"!=typeof o)throw new Error("Cannot use higher-order sections without the original template");c=c.call(n.view,o.slice(e[3],e[5]),i),null!=c&&(s+=c)}else s+=this.renderTokens(e[4],n,r,o);return s}},h.prototype.renderInverted=function(e,t,n,r){var o=t.lookup(e[1]);return!o||m(o)&&0===o.length?this.renderTokens(e[4],t,n,r):void 0},h.prototype.renderPartial=function(e,n,r){if(r){var o=t(r)?r(e[1]):r[e[1]];return null!=o?this.renderTokens(this.parse(o),n,r,o):void 0}},h.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);return null!=n?n:void 0},h.prototype.escapedValue=function(t,n){var r=n.lookup(t[1]);return null!=r?e.escape(r):void 0},h.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.2.0",e.tags=["{{","}}"];var R=new h;e.clearCache=function(){return R.clearCache()},e.parse=function(e,t){return R.parse(e,t)},e.render=function(e,t,r){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+n(e)+'" was given as the first argument for mustache#render(template, view, partials)');return R.render(e,t,r)},e.to_html=function(n,r,o,i){var a=e.render(n,r,o);return t(i)?void i(a):a},e.escape=s,e.Scanner=u,e.Context=p,e.Writer=h})},function(e,t,n){var r=n(3),o=n(4),i=function(e){this.url=e.url,this.service=e.service,this.both=e.both,this.clients={reddit:new r(e.url),hn:new o(e.url)}};i.prototype.genData=function(){var e=this;return Promise.all([e.clients.reddit.hasComments(),e.clients.hn.hasComments(),e.clients[e.service].getComments()])},i.prototype.fetch=function(){var e=this;return new Promise(function(t){e.genData().then(function(n){t({origUrl:e.url,service:e.service,hasReddit:n[0],hasHn:n[1],showBoth:e.both,data:n[2]})})})},e.exports=i},function(e,t){var n=function(e){var t="https://www.reddit.com",n="/search.json?q=url:",r=t+n+e;this.base=t,this.data=this.get(r)};n.prototype.get=function(e){return new Promise(function(t){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="json",n.addEventListener("load",function(){t(n)}),n.send()})},n.prototype.decode=function(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value},n.prototype.threadUrl=function(e,t){return this.base+"/r/"+e+"/comments/"+t+".json"},n.prototype.getThreads=function(e){var t=this,n=e.response,r=n.data.children.filter(function(e){return!!e.data.num_comments}),o=r.map(function(e){return new Promise(function(n){var r=t.threadUrl(e.data.subreddit,e.data.id);n(t.get(r))})});return Promise.all(o)},n.prototype.parseDate=function(e){var t=(new Date).getTime()/1e3,n=t-e,r=Math.floor(n/60),o=Math.floor(r/60),i=Math.floor(o/24);return 1===i?"1 day ago":i>0?i+" days ago":1===o?"1 hour ago":o>0?o+" hours ago":1===r?"1 minute ago":r>0?r+" minute ago":"a few seconds ago"},n.prototype.comment=function(e,t,n){var r=this,o=n||0,i={author:e.author,body_html:r.decode(e.body_html),created:r.parseDate(e.created_utc),id:e.id,score:e.score,subreddit:t.subreddit,permalink:r.base+t.permalink,thread:r.base+t.permalink+e.id,replies:null,hasReplies:!1,depth:o,isEven:function(){return this.depth%2===0}};if(e.replies&&e.replies.data.children.length>0){var a=o+1;i.hasReplies=!0,i.replies=e.replies.data.children.map(function(e){return r.comment(e.data,t,a)})}return i},n.prototype.parseComments=function(e){var t=this;return new Promise(function(n){var r=e.map(function(e){var n=e.response,r=n[0].data.children[0].data,o=n[1].data.children.map(function(e){return t.comment(e.data,r)});return{op:r,comments:o}});n(r)})},n.prototype.mergeComments=function(e){return new Promise(function(t){var n=function(t,r,o){if(o>e.length-1)return{score:t,threads:e.length,comments:r,multiple:function(){return this.threads>1}};var i=e[o],a=t+=i.op.score,s=r.concat(i.comments);return n(a,s,o+1)},r=n(0,[],0);r.comments=r.comments.sort(function(e,t){return t.score-e.score}),t(r)})},n.prototype.hasComments=function(){var e=this;return new Promise(function(t){e.data.then(function(e){var n=e.response,r=n.data.children.filter(function(e){return!!e.data.num_comments});t(!!r.length)})})},n.prototype.getComments=function(){var e=this;return new Promise(function(t){e.data.then(e.getThreads.bind(e)).then(e.parseComments.bind(e)).then(e.mergeComments.bind(e)).then(t)})},e.exports=n},function(e,t){var n=function(e){this.url=e};n.prototype.hasComments=function(){return!0},n.prototype.getComments=function(){return[{comment:"love it"},{comment:"wow!"}]},e.exports=n},function(e,t,n){var r=n(6);"string"==typeof r&&(r=[[e.id,r,""]]);n(8)(r,{});r.locals&&(e.exports=r.locals)},function(e,t,n){t=e.exports=n(7)(),t.push([e.id,'html{box-sizing:border-box}*,:after,:before{box-sizing:inherit}@-webkit-keyframes embeddFadeIn{0%{opacity:0}to{opacity:1}}@keyframes embeddFadeIn{0%{opacity:0}to{opacity:1}}.embedd-container{padding:20px 0 40px;-webkit-animation:embeddFadeIn .5s ease-in;animation:embeddFadeIn .5s ease-in}.embedd-container section{max-width:68em;margin-left:auto;margin-right:auto;max-width:none}.embedd-container section:after{clear:both;content:"";display:table}.embedd-container section h3,.embedd-container section p{color:#333}.embedd-container section a{color:#369;text-decoration:none}.embedd-container section article{float:left;display:block;margin-right:2.35765%;width:100%;padding:10px;padding-top:10px;margin-bottom:10px;border:1px solid #f2f2f2;border-radius:3px;background-color:#f5f5f5}.embedd-container section article:last-child{margin-right:0}.embedd-container section article p{margin:10px 0}.embedd-container section article span{margin-right:5px}.embedd-container section article .hideChildrenbtn:before{content:"[ - ]";font-style:normal}.embedd-container section article blockquote{margin:0;opacity:.7}.embedd-container section article blockquote p{padding-left:15px;border-left:1px solid #333}.embedd-container section article .children{padding-top:15px}.embedd-container section article.evenDepth{background-color:#fff}.embedd-container section article.closed .children,.embedd-container section article.closed .links,.embedd-container section article.closed .md{display:none}.embedd-container section article.closed .hideChildrenBtn:before{content:"[ + ]"}.embedd-container section article.closed span{font-style:italic;opacity:.7}@media only screen and (min-width:640px){.embedd-container section article{padding:20px}}',""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<t.length;o++){var a=t[o];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(e,t,n){function r(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=h[r.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](r.parts[i]);for(;i<r.parts.length;i++)o.parts.push(l(r.parts[i],t))}else{for(var a=[],i=0;i<r.parts.length;i++)a.push(l(r.parts[i],t));h[r.id]={id:r.id,refs:1,parts:a}}}}function o(e){for(var t=[],n={},r=0;r<e.length;r++){var o=e[r],i=o[0],a=o[1],s=o[2],c=o[3],l={css:a,media:s,sourceMap:c};n[i]?n[i].parts.push(l):t.push(n[i]={id:i,parts:[l]})}return t}function i(e,t){var n=v(),r=y[y.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),y.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function a(e){e.parentNode.removeChild(e);var t=y.indexOf(e);t>=0&&y.splice(t,1)}function s(e){var t=document.createElement("style");return t.type="text/css",i(e,t),t}function c(e){var t=document.createElement("link");return t.rel="stylesheet",i(e,t),t}function l(e,t){var n,r,o;if(t.singleton){var i=b++;n=g||(g=s(t)),r=d.bind(null,n,i,!1),o=d.bind(null,n,i,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=c(t),r=p.bind(null,n),o=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=s(t),r=u.bind(null,n),o=function(){a(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}function d(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=w(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function u(e,t){var n=t.css,r=t.media;t.sourceMap;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function p(e,t){var n=t.css,r=(t.media,t.sourceMap);r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([n],{type:"text/css"}),i=e.href;e.href=URL.createObjectURL(o),i&&URL.revokeObjectURL(i)}var h={},f=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},m=f(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),v=f(function(){return document.head||document.getElementsByTagName("head")[0]}),g=null,b=0,y=[];e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=m()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var n=o(e);return r(n,t),function(e){for(var i=[],a=0;a<n.length;a++){var s=n[a],c=h[s.id];c.refs--,i.push(c)}if(e){var l=o(e);r(l,t)}for(var a=0;a<i.length;a++){var c=i[a];if(0===c.refs){for(var d=0;d<c.parts.length;d++)c.parts[d]();delete h[c.id]}}}};var w=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t){e.exports="<section>\n  {{#data}}\n    {{#hasReddit}}\n    <h3>\n      {{score}} upvotes over {{threads}} thread{{#multiple}}s{{/multiple}} on {{service}}\n    </h3>\n    {{/hasReddit}}\n    \n    {{#comments}}\n      {{> comment}}\n	  {{/comments}}\n    \n	  {{^comments}}\n      <h3>No Comments on Reddit</h3>\n	  {{/comments}}\n    \n  {{/data}}\n</section>\n"},function(e,t){e.exports='<article {{#isEven}} class="evenDepth"{{/isEven}}>\n	\n	<aside>\n		<span>\n			<a class="hideChildrenBtn" href="javascript:void(0)"></a>\n		</span>\n		<span>\n			<a href="https://www.reddit.com/user/{{author}}" target="_blank">{{author}}</a>\n		</span>\n		<span><b>{{score}} points</b></span>\n		<span><a href="{{permalink}}">{{subreddit}}</a></span>\n		<span>{{created}}</span>\n	</aside>\n	\n  {{& body_html}}\n\n	<aside class="links">\n		<span>\n			<a href="{{thread}}" target="_blank">View on Reddit</a>\n		</span>\n	</aside>\n\n	{{#hasReplies}}\n	<div class="children">\n		{{#replies}}\n		{{> comment}}\n		{{/replies}}\n	</div>\n	{{/hasReplies}}\n\n</article>\n'}]);